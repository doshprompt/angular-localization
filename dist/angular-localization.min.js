/*!
 * angular-localization :: v1.3.0 :: 2015-07-23
 * web: http://doshprompt.github.io/angular-localization
 *
 * Copyright (c) 2015 | Rahul Doshi
 * License: MIT
 */
!function(e,n,t,o){"use strict";e.module("ngLocalize.Version",[]).constant("localeVer","1.3.0"),e.module("ngLocalize",["ngSanitize","ngLocalize.Config","ngLocalize.Events","ngLocalize.InstalledLanguages"]),e.module("ngLocalize.InstalledLanguages",[]).value("localeSupported",["en-US"]).value("localeFallbacks",{en:"en-US"}),e.module("ngLocalize").service("locale",["$injector","$http","$q","$log","$rootScope","$window","localeConf","localeEvents","localeSupported","localeFallbacks",function(n,t,o,a,i,r,l,c,s,u){function g(e){return e&&e.length&&O.test(e)}function f(e){var n=e?e.split("."):"",t="";return n.length>1&&(t=n.slice(0,-1).join(".")),t}function d(e){var n=e?e.split("."):[],t="";return n.length&&(t=n[n.length-1]),t}function v(e){var n,t=null,o=e?e.split("."):[];if(o.length>1)for(t=k,n=0;n<o.length-1;n++){if(!t[o[n]]){t=null;break}t=t[o[n]]}return t}function h(e){var n,o=e?e.split("."):"",r=k,s=l.basePath+"/"+b;if(o.length>1){for(n=0;n<o.length-1;n++)r[o[n]]||(r[o[n]]={}),r=r[o[n]],s+="/"+o[n];r._loading||(r._loading=!0,s+=l.fileExtension,t.get(s).success(function(n){var t,o=f(e);for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);delete r._loading,i.$broadcast(c.resourceUpdates),z[o]&&z[o].resolve(o)}).error(function(){a.error("[localizationService] Failed to load: "+s),delete r._loading}))}}function p(e){var n,t;return e=e||l.langFile,t=e+"._LOOKUP_",n=v(t),z[e]||(z[e]=o.defer()),n&&!n._loading?z[e].resolve(e):n||h(t),z[e].promise}function m(n){var t,a,i;if(e.isString(n))t=n.split(",");else{if(!e.isArray(n))throw new Error("locale.ready requires either an Array or comma-separated list.");t=n}return t.length>1?(i=[],t.forEach(function(e){i.push(p(e))}),a=o.all(i)):a=p(n),a}function L(n,t){var o=n,a=0;return t&&(e.isArray(t)?e.forEach(t,function(e,n){o=o.replace("%"+(n+1),e),o=o.replace("{"+(n+1)+"}",e)}):e.forEach(t,function(e,n){++a,o=o.replace("{"+n+"}",e),o=o.replace("%"+n,e),o=o.replace("%"+a,e),o=o.replace("{"+a+"}",e)})),o=o.replace(/\n/g,"<br>")}function $(n,t){var o,i,r,c="",s=!1;return e.isString(n)&&!t&&-1!==n.indexOf(l.delimiter)&&(r=n.split(l.delimiter),n=r[0],t=e.fromJson(r[1])),s=g(n),s?(e.isObject(t)||(t=[t]),o=v(n),o&&!o._loading?(i=d(n),o[i]?c=L(o[i],t):(a.info("[localizationService] Key not found: "+n),c="%%KEY_NOT_FOUND%%")):o||h(n)):c=n,c}function S(n){var t;e.isString(n)?(n=n.trim(),-1!==s.indexOf(n)?t=n:(t=u[n.split("-")[0]],e.isUndefined(t)&&(t=l.defaultLocale))):t=l.defaultLocale,t!==b&&(k={},z={},b=t,i.$broadcast(c.localeChanges,b),i.$broadcast(c.resourceUpdates),C&&C.put(l.cookieName,t))}function E(){return b}var b,z,k,C,O=new RegExp("^[\\w\\.-]+\\.[\\w\\s\\.-]+\\w(:.*)?$");return l.persistSelection&&n.has("$cookieStore")&&(C=n.get("$cookieStore")),S(C&&C.get(l.cookieName)?C.get(l.cookieName):r.navigator.userLanguage||r.navigator.language),{ready:m,isToken:g,getPath:f,getKey:d,setLocale:S,getLocale:E,getString:$}}]),e.module("ngLocalize").filter("i18n",["locale",function(e){var n=function(n,t){return e.getString(n,t)};return n.$stateful=!0,n}]),e.module("ngLocalize.Events",[]).constant("localeEvents",{resourceUpdates:"ngLocalizeResourcesUpdated",localeChanges:"ngLocalizeLocaleChanged"}),e.module("ngLocalize").directive("i18n",["$sce","locale","localeEvents","localeConf",function(n,t,o,a){function i(e,t){t!==e.html()&&e.html(n.getTrustedHtml(t))}function r(e,n,o){t.isToken(n)?t.ready(t.getPath(n)).then(function(){i(e,t.getString(n,o))}):i(e,n)}return function(n,t,i){var l;i.$observe("i18n",function(e,n){e&&e!==n&&r(t,e,l)}),e.forEach(i.$attr,function(e,n){a.observableAttrs.test(e)&&i.$observe(n,function(e){!e&&l&&l[n]||(l=l||{},l[n]=i[n],r(t,i.i18n,l))})}),n.$on(o.resourceUpdates,function(){r(t,i.i18n,l)}),n.$on(o.localeChanges,function(){r(t,i.i18n,l)})}}]).directive("i18nAttr",["locale","localeEvents",function(e,n){return function(t,o,a){function i(n,o){var i,l=t.$eval(o),c=[];for(var s in l)i=l[s],e.isToken(i)&&-1===c.indexOf(e.getPath(i))&&c.push(e.getPath(i));e.ready(c).then(function(){var n="";for(var t in l)i=l[t],n=e.getString(i),r[t]!==n&&a.$set(t,r[t]=n)})}var r={};a.$observe("i18nAttr",function(e){e&&i(o,e)}),t.$on(n.resourceUpdates,function(){i(o,a.i18nAttr)}),t.$on(n.localeChanges,function(){i(o,a.i18nAttr)})}}]),e.module("ngLocalize.Config",[]).value("localeConf",{basePath:"languages",defaultLocale:"en-US",sharedDictionary:"common",fileExtension:".lang.json",persistSelection:!0,cookieName:"COOKIE_LOCALE_LANG",observableAttrs:new RegExp("^data-(?!ng-|i18n)"),delimiter:"::"})}(this.angular,this,this.document);
//# sourceMappingURL=angular-localization.min.js.map